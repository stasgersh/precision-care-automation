{
  "name": "<SCRIPT SRC=https://cdn.jsdelivr.net/gh/Moksh45/host-xss.rocks/index.js></SCRIPT>\n",
  "protocols": [
    {
      "name": "javascript:/*--></title></style></textarea></script></xmp> <svg/onload='+/\"`/+/onmouseover=1/+/[*/[]/+alert(42);//'>\n",
      "events": [
        {
          "id": "ARD",
          "name": "\\<a onmouseover=\"alert(document.cookie)\"\\>xxs link\\</a\\>\n",
          "relativeTiming": {
            "days": 0
          },
          "toleranceBefore": {
            "days": -2
          },
          "toleranceAfter": {
            "days": 2
          },
          "scheduleQuery": {
            "alias": "ard",
            "query": {
              "from": "<IMG \"\"\"><SCRIPT>alert(\"XSS\")</SCRIPT>\"\\>\n",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "<IMG SRC=\"jav&#x09;ascript:alert('XSS');\">\n"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "<IMG SRC=javascript:alert(String.fromCharCode(88,83,83))>\n",
            "query": {
              "from": "<IMG SRC=\"jav&#x0A;ascript:alert('XSS');\">\n",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "ardMedication"
                    }
                  }
                ]
              }
            }
          },
          "category": "treatmentAndPlan"
        },
        {
          "id": "PSA-1",
          "name": "PSA",
          "dependsOn": "ARD",
          "relativeTiming": {
            "days": -21
          },
          "toleranceBefore": {
            "days": -10
          },
          "toleranceAfter": {
            "days": 10
          },
          "scheduleQuery": {
            "alias": "psa",
            "query": {
              "from": "<IMG SRC=\"jav&#x0D;ascript:alert('XSS');\">\n",
              "dedup": true,
              "filter": {
                "must": [
                  {
                    "subtypes": {
                      "eq": "psaMeasurement"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psa",
            "query": {
              "from": "perl -e 'print \"<IMG SRC=java\\0script:alert(\\\"XSS\\\")>\";' > out\n",
              "filter": {
                "should": [
                  {
                    "attributes.code.$coding.code": {
                      "eq": "2857-1"
                    }
                  }
                ]
              }
            }
          },
          "category": "biomarkers",
          "futureCategory": "pathology",
          "futureName": "PSA measurement"
        },
        {
          "id": "PSMA PET-1",
          "name": "PSMA PET scan",
          "dependsOn": "ARD",
          "relativeTiming": {
            "days": -21
          },
          "toleranceBefore": {
            "days": -10
          },
          "toleranceAfter": {
            "days": 10
          },
          "scheduleQuery": {
            "alias": "psma",
            "query": {
              "from": "imagingStudyRequest",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "psmaPetStudy"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psma",
            "query": {
              "from": "imagingReport",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "psmaPetStudy"
                    }
                  }
                ]
              }
            }
          },
          "category": "radiology"
        },
        {
          "id": "PSA-2",
          "name": "PSA",
          "dependsOn": "ARD",
          "relativeTiming": {
            "months": 3,
            "days": 2
          },
          "toleranceBefore": {
            "days": -14
          },
          "toleranceAfter": {
            "days": 14
          },
          "scheduleQuery": {
            "alias": "psa",
            "query": {
              "from": "labReport",
              "dedup": true,
              "filter": {
                "must": [
                  {
                    "subtypes": {
                      "eq": "psaMeasurement"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psa",
            "query": {
              "from": "prostateTumorMarkerTestResult",
              "filter": {
                "should": [
                  {
                    "attributes.code.$coding.code": {
                      "eq": "2857-1"
                    }
                  }
                ]
              }
            }
          },
          "category": "biomarkers",
          "futureCategory": "pathology",
          "futureName": "PSA measurement"
        },
        {
          "id": "visit-1",
          "name": "Oncology visit",
          "dependsOn": "PSA-2",
          "relativeTiming": {
            "days": 3
          },
          "toleranceBefore": {
            "days": -2
          },
          "toleranceAfter": {
            "days": 2
          },
          "scheduleQuery": {
            "alias": "visit",
            "query": {
              "from": "oncologyVisit",
              "filter": {
                "should": [
                  {
                    "attributes.$type.$coding.code": {
                      "eq": "214"
                    }
                  },
                  {
                    "attributes.code.$coding.code": {
                      "eq": "214"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "visit",
            "query": {
              "from": "oncologyVisit",
              "filter": {
                "should": [
                  {
                    "attributes.$type.$coding.code": {
                      "eq": "214"
                    }
                  },
                  {
                    "attributes.code.$coding.code": {
                      "eq": "214"
                    }
                  }
                ]
              }
            }
          },
          "category": "encounters"
        },
        {
          "id": "PSA-3",
          "name": "PSA",
          "dependsOn": "PSA-2",
          "relativeTiming": {
            "months": 3
          },
          "toleranceBefore": {
            "days": -14
          },
          "toleranceAfter": {
            "days": 14
          },
          "scheduleQuery": {
            "alias": "psa",
            "query": {
              "from": "labReport",
              "dedup": true,
              "filter": {
                "must": [
                  {
                    "subtypes": {
                      "eq": "psaMeasurement"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psa",
            "query": {
              "from": "prostateTumorMarkerTestResult",
              "filter": {
                "should": [
                  {
                    "attributes.code.$coding.code": {
                      "eq": "2857-1"
                    }
                  }
                ]
              }
            }
          },
          "category": "biomarkers",
          "futureCategory": "pathology",
          "futureName": "PSA measurement"
        },
        {
          "id": "PSMA PET-2",
          "name": "PSMA PET scan",
          "dependsOn": "PSA-2",
          "relativeTiming": {
            "months": 3
          },
          "toleranceBefore": {
            "days": -14
          },
          "toleranceAfter": {
            "days": 14
          },
          "scheduleQuery": {
            "alias": "psma",
            "query": {
              "from": "imagingStudyRequest",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "psmaPetStudy"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psma",
            "query": {
              "from": "imagingReport",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "psmaPetStudy"
                    }
                  }
                ]
              }
            }
          },
          "category": "radiology"
        },
        {
          "id": "PSA-4",
          "name": "PSA",
          "dependsOn": "PSA-3",
          "relativeTiming": {
            "months": 3
          },
          "toleranceBefore": {
            "days": -14
          },
          "toleranceAfter": {
            "days": 14
          },
          "scheduleQuery": {
            "alias": "psa",
            "query": {
              "from": "labReport",
              "dedup": true,
              "filter": {
                "must": [
                  {
                    "subtypes": {
                      "eq": "psaMeasurement"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psa",
            "query": {
              "from": "prostateTumorMarkerTestResult",
              "filter": {
                "should": [
                  {
                    "attributes.code.$coding.code": {
                      "eq": "2857-1"
                    }
                  }
                ]
              }
            }
          },
          "category": "biomarkers",
          "futureCategory": "pathology",
          "futureName": "PSA measurement"
        },
        {
          "id": "PSA-5",
          "name": "PSA",
          "dependsOn": "PSA-4",
          "relativeTiming": {
            "months": 3
          },
          "toleranceBefore": {
            "days": -14
          },
          "toleranceAfter": {
            "days": 14
          },
          "scheduleQuery": {
            "alias": "psa",
            "query": {
              "from": "labReport",
              "dedup": true,
              "filter": {
                "must": [
                  {
                    "subtypes": {
                      "eq": "psaMeasurement"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psa",
            "query": {
              "from": "prostateTumorMarkerTestResult",
              "filter": {
                "should": [
                  {
                    "attributes.code.$coding.code": {
                      "eq": "2857-1"
                    }
                  }
                ]
              }
            }
          },
          "category": "biomarkers",
          "futureCategory": "pathology",
          "futureName": "PSA measurement"
        },
        {
          "id": "PSMA PET-3",
          "name": "PSMA PET scan",
          "dependsOn": "PSA-4",
          "relativeTiming": {
            "months": 3
          },
          "toleranceBefore": {
            "days": -14
          },
          "toleranceAfter": {
            "days": 14
          },
          "scheduleQuery": {
            "alias": "psma",
            "query": {
              "from": "imagingStudyRequest",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "psmaPetStudy"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "psma",
            "query": {
              "from": "imagingReport",
              "filter": {
                "should": [
                  {
                    "subtypes": {
                      "eq": "psmaPetStudy"
                    }
                  }
                ]
              }
            }
          },
          "category": "radiology"
        },
        {
          "id": "visit-2",
          "name": "Oncology visit",
          "dependsOn": "PSA-5",
          "relativeTiming": {
            "days": 5
          },
          "toleranceBefore": {
            "days": -4
          },
          "toleranceAfter": {
            "days": 3
          },
          "scheduleQuery": {
            "alias": "visit",
            "query": {
              "from": "oncologyVisit",
              "filter": {
                "should": [
                  {
                    "attributes.$type.$coding.code": {
                      "eq": "214"
                    }
                  },
                  {
                    "attributes.code.$coding.code": {
                      "eq": "214"
                    }
                  }
                ]
              }
            }
          },
          "eventQuery": {
            "alias": "visit",
            "query": {
              "from": "oncologyVisit",
              "filter": {
                "should": [
                  {
                    "attributes.$type.$coding.code": {
                      "eq": "214"
                    }
                  },
                  {
                    "attributes.code.$coding.code": {
                      "eq": "214"
                    }
                  }
                ]
              }
            }
          },
          "firstPostProtocolEvent": true,
          "category": "encounters"
        }
      ]
    }
  ]
}